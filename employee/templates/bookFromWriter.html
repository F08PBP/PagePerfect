<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Perfect</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<h1>Book From Writer</h1>
<div id="data-container">
    
</div>

<script>
    $(document).ready(function() {
        $.ajax({
            url: 'api/acc',  
            type: 'GET',
            dataType: 'json',
            success: function(data) {
                // Handle the returned data here

                for (var i = 0; i < data.length; i++) {
                    var item = data[i];
                    var buttonA = $('<button>').text('Accepted');
                    
                        buttonA.click(function(){
                        // Perform AJAX POST request when the button is clicked
                        $.ajax({
                            type: 'POST',
                            url: 'acceptBook',  // Replace with your actual POST URL endpoint
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                book_id: item.fields.bookID // Include any necessary data for the POST request
                            },
                            success: function(response){
                                // Handle success response
                                console.log('The book was accepted');
                                location.reload();
                            },
                            error: function(){
                                // Handle error if the AJAX request fails
                                console.error('Failed to perform POST request.');
                            }
                        });
                    });
                        


                    var buttonD = $('<button>').text('Denied');

                        buttonD.click(function(){
                        // Perform AJAX POST request when the button is clicked
                        $.ajax({
                            type: 'POST',
                            url: 'deniedBook',  // Replace with your actual POST URL endpoint
                            data: {
                                csrfmiddlewaretoken: '{{ csrf_token }}',
                                book_id: item.fields.bookID // Include any necessary data for the POST request
                            },
                            success: function(response){
                                // Handle success response
                                console.log('The book was accepted');
                                location.reload();
                            },
                            error: function(){
                                // Handle error if the AJAX request fails
                                console.error('Failed to perform POST request.');
                            }
                        });
                    });
                // Do something with each item, for example, append it to a list
                    $('#data-container').append('<li>ID: ' + item.fields.bookID + 
                        ', Name: ' + item.fields.title + 
                        '</li>', buttonA, buttonD);
                }
            },
            error: function(error) {
                console.log(error);
            }
        });
    });
</script>

</body>
</html>